using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;

[RequireComponent(typeof(InputField))]
public class ValidateInputText : MonoBehaviour {
    static readonly char[] emojiCodes = new char[167] {
        (char)0x00A9,
        (char)0x00AE,
        (char)0x203C,
        (char)0x2049,
        (char)0x2122,
        (char)0x2139,
        (char)0x2194,
        (char)0x2195,
        (char)0x2196,
        (char)0x2197,
        (char)0x2198,
        (char)0x2199,
        (char)0x21A9,
        (char)0x21AA,
        (char)0x231A,
        (char)0x231B,
        (char)0x2328,
        (char)0x23CF,
        (char)0x23E9,
        (char)0x23EA,
        (char)0x23EB,
        (char)0x23EC,
        (char)0x23ED,
        (char)0x23EE,
        (char)0x23EF,
        (char)0x23F0,
        (char)0x23F1,
        (char)0x23F2,
        (char)0x23F3,
        (char)0x23F8,
        (char)0x23F9,
        (char)0x23FA,
        (char)0x24C2,
        (char)0x25AA,
        (char)0x25AB,
        (char)0x25B6,
        (char)0x25C0,
        (char)0x25FB,
        (char)0x25FC,
        (char)0x25FD,
        (char)0x25FE,
        (char)0x2600,
        (char)0x2601,
        (char)0x2602,
        (char)0x2603,
        (char)0x2604,
        (char)0x260E,
        (char)0x2611,
        (char)0x2614,
        (char)0x2615,
        (char)0x2618,
        (char)0x261D,
        (char)0x2620,
        (char)0x2622,
        (char)0x2623,
        (char)0x2626,
        (char)0x262A,
        (char)0x262E,
        (char)0x262F,
        (char)0x2638,
        (char)0x2639,
        (char)0x263A,
        (char)0x2640,
        (char)0x2642,
        (char)0x2648,
        (char)0x2649,
        (char)0x264A,
        (char)0x264B,
        (char)0x264C,
        (char)0x264D,
        (char)0x264E,
        (char)0x264F,
        (char)0x2650,
        (char)0x2651,
        (char)0x2652,
        (char)0x2653,
        (char)0x2660,
        (char)0x2663,
        (char)0x2665,
        (char)0x2666,
        (char)0x2668,
        (char)0x267B,
        (char)0x267F,
        (char)0x2692,
        (char)0x2693,
        (char)0x2694,
        (char)0x2695,
        (char)0x2696,
        (char)0x2697,
        (char)0x2699,
        (char)0x269B,
        (char)0x269C,
        (char)0x26A0,
        (char)0x26A1,
        (char)0x26AA,
        (char)0x26AB,
        (char)0x26B0,
        (char)0x26B1,
        (char)0x26BD,
        (char)0x26BE,
        (char)0x26C4,
        (char)0x26C5,
        (char)0x26C8,
        (char)0x26CE,
        (char)0x26CF,
        (char)0x26D1,
        (char)0x26D3,
        (char)0x26D4,
        (char)0x26E9,
        (char)0x26EA,
        (char)0x26F0,
        (char)0x26F1,
        (char)0x26F2,
        (char)0x26F3,
        (char)0x26F4,
        (char)0x26F5,
        (char)0x26F7,
        (char)0x26F8,
        (char)0x26F9,
        (char)0x26FA,
        (char)0x26FD,
        (char)0x2702,
        (char)0x2705,
        (char)0x2708,
        (char)0x2709,
        (char)0x270A,
        (char)0x270B,
        (char)0x270C,
        (char)0x270D,
        (char)0x270F,
        (char)0x2712,
        (char)0x2714,
        (char)0x2716,
        (char)0x271D,
        (char)0x2721,
        (char)0x2728,
        (char)0x2733,
        (char)0x2734,
        (char)0x2744,
        (char)0x2747,
        (char)0x274C,
        (char)0x274E,
        (char)0x2753,
        (char)0x2754,
        (char)0x2755,
        (char)0x2757,
        (char)0x2763,
        (char)0x2764,
        (char)0x2795,
        (char)0x2796,
        (char)0x2797,
        (char)0x27A1,
        (char)0x27B0,
        (char)0x27BF,
        (char)0x2934,
        (char)0x2935,
        (char)0x2B05,
        (char)0x2B06,
        (char)0x2B07,
        (char)0x2B1B,
        (char)0x2B1C,
        (char)0x2B50,
        (char)0x2B55,
        (char)0x3030,
        (char)0x303D,
        (char)0x3297,
        (char)0x3299
    };
    InputField input;
    void Awake() {
        input = GetComponent<InputField> ();
        if (input != null) {
            input.onValidateInput += ValidateInput;
        }
    }

    char ValidateInput(string text, int charIndex, char addedChar) {
        //Debug.Log ("ValidateInput:" + text + " addChar = " + addedChar);
        if (char.IsSurrogate (addedChar)) {
            //Debug.Log ("ValidateInput: Salogate Pair");
            // サロゲートペアの場合には削除
            return '\0';
        } else if (System.Array.FindIndex (emojiCodes, x => x == addedChar) >= 0) {
            //Debug.Log ("ValidateInput: EmojiCodes");
            return '\0';
        } else if (addedChar == (char)0xFE0F || addedChar == (char)0xFE0E) {
            //Debug.Log ("ValidateInput: VS16");
            return '\0';
        }
        return addedChar;
    }
}
